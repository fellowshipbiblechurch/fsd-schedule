$(document).ready(function(){if($(".schedule__wrapper")){createDanceSchedule();createMobileTabs()}});function createDanceSchedule(){if($(window).width()<847){$(".schedule__wrapper").addClass("compressed")}function danceClass(day,studio,title,link,alphaHour,alphaMinute,omegaHour,omegaMinute){this.day=day;this.studio=studio;this.title=title;this.link=link;this.times={alpha:{hour:alphaHour,minute:alphaMinute},omega:{hour:omegaHour,minute:omegaMinute}};this.alphaMinutesFull=function(){return alphaHour*60+alphaMinute};this.omegaMinutesFull=function(){return omegaHour*60+omegaMinute};this.duration=function(){return(omegaHour*60+omegaMinute-(alphaHour*60+alphaMinute))/15}}var monday=[new danceClass("Monday","A","Waltz The Big Deal","/a",12,0,13,45),new danceClass("Monday","A","Beebop XI","/a",14,0,15,30),new danceClass("Monday","B","Advanced Polka","/b",12,0,13,30),new danceClass("Monday","B","Beginner's Dougie","/b",13,30,15,0),new danceClass("Monday","C","Shuffle II/III","/c",13,15,14,45),new danceClass("Monday","C","Lindy","/c",15,0,16,30)];var tuesday=[new danceClass("Tuesday","A","Richard Simmons Rumba","/a",14,30,15,0),new danceClass("Tuesday","A","Lyrical Quilting III","/a",15,0,15,45),new danceClass("Tuesday","A","What Da Foxtrot Say?","/b",15,45,17,15),new danceClass("Tuesday","B","Ballet in Jesus' Time","/b",13,45,15,15),new danceClass("Tuesday","B","Jazz Tap with Elton","/b",15,15,16,30),new danceClass("Tuesday","C","Touchdown Celebrations I","/c",14,45,17,0)];var wednesday=[new danceClass("Wednesday","A","It Takes Tutu to Tango","/a",12,45,14,45),new danceClass("Wednesday","B","Advanced Swaying","/b",12,30,13,30),new danceClass("Wednesday","B","Waltz Whitman II/III","/b",13,30,15,30),new danceClass("Wednesday","C","Dancing for Baptists I","/c",12,30,13,0),new danceClass("Wednesday","C","Chips and Salsa","/c",13,0,14,0),new danceClass("Wednesday","C","Lemon Merengue","/c",14,0,15,0)];var thursday=[new danceClass("Thursday","A","Richard Simmons Rumba","/a",14,30,15,30),new danceClass("Thursday","A","Lyrical Quilting III","/a",15,30,17,0),new danceClass("Thursday","A","What Da Foxtrot Say?","/b",17,0,19,0),new danceClass("Thursday","B","Ballet in Jesus' Time","/b",13,45,14,45),new danceClass("Thursday","B","Jazz Tap with Elton","/b",14,45,16,30),new danceClass("Thursday","C","Touchdown Celebrations I","/c",16,0,18,30)];var friday=[new danceClass("Friday","A","Waltz The Big Deal","/a",12,0,13,45),new danceClass("Friday","A","Beebop XI","/a",14,0,15,30),new danceClass("Friday","B","Advanced Polka","/b",12,0,13,30),new danceClass("Friday","B","Beginner's Dougie","/b",13,30,15,0),new danceClass("Friday","C","Shuffle II/III","/c",13,15,14,45),new danceClass("Friday","C","Lindy","/c",15,0,16,30)];var days=[monday,tuesday,wednesday,thursday,friday],studioA,studioB,studioC;function buildStudios(day){studioA=[];studioB=[];studioC=[];for(var i=0;i<day.length;i++){var studio=day[i].studio;if(studio==="A"){studioA.push(day[i])}else if(studio==="B"){studioB.push(day[i])}else if(studio==="C"){studioC.push(day[i])}}}var getScheduleAlphaTime=function(day){var earliestStart=1440;for(var i=0;i<day.length;i++){day[i].alphaMinutesFull()<earliestStart?earliestStart=day[i].alphaMinutesFull():earliestStart=earliestStart}return earliestStart-=15};var getScheduleOmegaTime=function(day){var latestEnd=0;for(var i=0;i<day.length;i++){day[i].omegaMinutesFull()>latestEnd?latestEnd=day[i].omegaMinutesFull():latestEnd=latestEnd}return latestEnd+=15};var prettifyTime=function(ugly){var t,h,m,am,meridiem,hours,minutes,prettyTime;t=ugly/60;h=Math.floor(t);m=Math.round(Math.abs(h-t)*60);meridiem=h>=12?"pm":"am";hours=h<=12?h:h-12;minutes=m<10?"0"+m:m;prettyTime=hours+":"+minutes+meridiem;return prettyTime};var howManyRows=function(day){var count=getScheduleOmegaTime(day)-getScheduleAlphaTime(day);return count/15};function formatClassTimes(){var times=document.getElementsByClassName("class__times");for(var i=0;i<times.length;i++){var text=times[i].innerHTML;var timeAlpha=text.split("-")[0];var timeOmega=text.split("-")[1];var meridiemAlpha=timeAlpha.split("am")[1]===""?"am":"pm";var meridiemOmega=timeOmega.split("am")[1]===""?"am":"pm";var formattedTime=meridiemAlpha===meridiemOmega?timeAlpha.split(meridiemAlpha)[0]+"-"+timeOmega:timeAlpha+"-"+timeOmega;times[i].innerHTML=formattedTime}}var createClassCell=function(currentTime,studioArray,column){var isEmpty=true,cellHTML;for(var i=0;i<studioArray.length;i++){var studio=studioArray[i].studio.toLowerCase(),title=studioArray[i].title,link=studioArray[i].link,timeAlpha=studioArray[i].alphaMinutesFull(),timeOmega=studioArray[i].omegaMinutesFull(),duration=studioArray[i].duration(),dataStudio;if(studio==="a"){dataStudio="a"}else if(studio==="b"){dataStudio="b"}else if(studio==="c"){dataStudio="c"}if(timeAlpha==currentTime){isEmpty=false;cellHTML='<td class="cell__class cell__class--studio-'+studio;cellHTML+=studio==="c"?" cell--border-cancel-right":"";cellHTML+='" rowspan="'+duration+'"';cellHTML+=' data-studio="'+dataStudio+'">';cellHTML+='<a href="'+link+'">';cellHTML+='<span class="class__title">'+title+"</span>";cellHTML+='<span class="class__times">'+prettifyTime(timeAlpha)+"-"+prettifyTime(timeOmega)+"</span>";cellHTML+="</a>";cellHTML+="</td>";break}else if(timeAlpha<currentTime&&timeOmega>currentTime){isEmpty=false;break}}if(isEmpty){cellHTML='<td class="cell--blank';cellHTML+=studio==="c"?' cell--border-cancel-right"':'"';cellHTML+=' data-studio="'+dataStudio;cellHTML+='">&nbsp;</td>'}return cellHTML};var buildSchedule=function(day){buildStudios(day);var rowHTML="";for(var i=0;i<howManyRows(day);i++){var indexTime=getScheduleAlphaTime(day)+15*i;rowHTML+="<tr>";rowHTML+='<td class="cell__index">'+prettifyTime(indexTime)+"</td>";rowHTML+=createClassCell(indexTime,studioA,i);rowHTML+=createClassCell(indexTime,studioB,i);rowHTML+=createClassCell(indexTime,studioC,i);rowHTML+="</tr>"}return rowHTML};var dayCurrIndex,dayPrevIndex,dayNextIndex,dayCurr,dayPrev,dayNext,panelPosNew,translation,width_Schedule=$(".schedule__wrapper").width(),width_Panels=width_Schedule*days.length,width_Panel=width_Schedule,$dayName=$("#dayName"),$panels=$(".schedule__panels");var logDayReport=function(){console.log("------");console.log("dayPrevIndex",dayPrevIndex);console.log("dayCurrIndex",dayCurrIndex);console.log("dayNextIndex",dayNextIndex);console.log("dayPrev",dayPrev);console.log("dayCurr",dayCurr);console.log("dayNext",dayNext);console.log("panelPosNew",panelPosNew)};(function(){var d=new Date;var n=d.getDay();var today=days[n-1];var todayStr=today[0].day;$dayName.text(todayStr);dayCurr=$dayName.text()})();for(var i=0;i<days.length;i++){if(dayCurr===days[i][0].day){dayPrevIndex=i-1;dayCurrIndex=i;dayNextIndex=i+1;break}}(function(){var dayArray,dayName,panelId;for(var i=0;i<days.length;i++){dayArray=days[i];dayName=dayArray[0].day.toLowerCase();panelId="#"+dayName;$(panelId).html(buildSchedule(dayArray))}formatClassTimes()})();function updateDayMeta(direction){if(direction==="prev"){dayCurrIndex-=1}if(direction==="next"){dayCurrIndex+=1}dayCurrIndex<0||dayCurrIndex>4?dayCurrIndex=dayCurrIndex<0?4:0:dayCurrIndex;panelPosNew=-1*width_Panel*dayCurrIndex;dayCurr=days[dayCurrIndex][0].day;$dayName.text(dayCurr);dayPrevIndex=dayCurrIndex-1;dayNextIndex=dayCurrIndex+1;dayPrevIndex=dayPrevIndex===-1?dayPrevIndex+=5:dayPrevIndex;dayPrev=days[dayPrevIndex][0].day;dayNextIndex=dayNextIndex===5?dayNextIndex-=5:dayNextIndex;dayNext=days[dayNextIndex][0].day;$(".day__prev").attr("title","View "+dayPrev+"'s Classes");$(".day__next").attr("title","View "+dayNext+"'s Classes");translationVal="translateX("+panelPosNew+"px)";$panels.css({transform:translationVal});$(".schedule__panel").each(function(){$(this).attr("id")===dayCurr.toLowerCase()?$(this).addClass("active"):$(this).removeClass("active")})}updateDayMeta();$(".day__change").on("click",function(e){$(this).attr("id")==="dayPrev"?updateDayMeta("prev"):updateDayMeta("next");e.preventDefault()})}function createMobileTabs(){if($(".schedule__wrapper").hasClass("compressed")){$(".schedule__wrapper").each(function(){var $cells=$("td").not(".cell__index, .cell__heading, .cell__heading--blank");var $arrows=$(".studio__arrow");var studios=[$cells.filter($('[data-studio="a"]')),$cells.filter($('[data-studio="b"]')),$cells.filter($('[data-studio="c"]'))];var $headings=$('[class*="cell__heading--studio-"]');studios[0].addClass("visible");$($arrows[0]).addClass("active");$($headings[0]).addClass("active");$headings.each(function(){$(this).on("click",function(e){var $thisHeading=$(this);var $thisArrow=$(this).find(".studio__arrow");var activeStudio=$(this).children().first().text().toLowerCase().split(" ")[1];$thisArrow.addClass("active");$thisHeading.addClass("active");$arrows.not($thisArrow).removeClass("active");$headings.not($thisHeading).removeClass("active");var visibleCells=$cells.filter($('[data-studio="'+activeStudio+'"]'));var hiddenCells=$cells.not(visibleCells);visibleCells.show().addClass("visible").removeClass("hidden");hiddenCells.addClass("hidden").removeClass("visible").hide();e.preventDefault()})})})}}